<html>

<head>
  <!-- Link to Twitter Bootstrap -->
  	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>LocateYourWaste - Drop-Offs</title>
  <!-- plugins:css -->
  <!-- <link rel="stylesheet" href="vendors/feather/feather.css">
  <link rel="stylesheet" href="vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="vendors/typicons/typicons.css">
  <link rel="stylesheet" href="vendors/simple-line-icons/css/simple-line-icons.css">
  <link rel="stylesheet" href="vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <!-- <link rel="stylesheet" href="vendors/datatables.net-bs4/dataTables.bootstrap4.css">
  <link rel="stylesheet" href="js/select.dataTables.min.css"> -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">


  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="{{ url_for('static',filename='assets/css/vertical-layout-light/style.css') }}">
  <!-- endinject -->


  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <!-- <link href="/Green/assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="/Green/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/Green/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/Green/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="/Green/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="/Green/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet"> -->

  <!-- Template Main CSS File -->
  <link href="{{ url_for('static',filename='assets/css/style.css') }}" rel="stylesheet">
</head>

<script>
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const dropoff_type_param = urlParams.get("dropoff_type");
const dropoff_name_param = urlParams.get('dropoff_name');
api_call_params = new URLSearchParams();
if (dropoff_type_param && dropoff_name_param)
{
api_call_params= new URLSearchParams({
    dropoff_type_query: dropoff_type_param,
    dropoff_name_query: dropoff_name_param
  });
}
else if (dropoff_type_param)
{
  api_call_params= new URLSearchParams({
    dropoff_type_query: dropoff_type_param
  });
}
else if (dropoff_name_param)
{
  api_call_params= new URLSearchParams({
    dropoff_name_query: dropoff_name_param
  });
}

</script>

<body>
<header id="header" class="d-flex align-items-center" style="background: #5cb874;">
        <div class="container d-flex align-items-center">

            <h2 class="logo me-auto"><a href="/" style="color: white;">LocateYourWaste</a></h2>
            <!-- Uncomment below if you prefer to use an image logo -->
            <!-- <a href="index.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

            <nav id="navbar" class="navbar" style="background-color:#5cb874;">
                <ul>
                    <li><a class="nav-link scrollto active" href="/" style="color: white;">Home</a></li>

                    <li><a class="nav-link scrollto" href="/nycwaste" style="color: white;">Waste in NYC</a></li>
                    <!-- <li><a class="nav-link scrollto " href="#borough">Waste by Boroughs</a></li> -->

                    <li class="dropdown"><a href="/boro" style="color: white;"><span style="color: white;">Waste
                                by Boroughs</span> <i class="bi bi-chevron-down"></i></a>
                        <ul>
                            <li><a href="/bronx#bronx">Bronx</a></li>
                            <li><a href="/brooklyn#brooklyn">Brooklyn</a></li>
                            <li><a href="/manhattan#manhattan">Manhattan</a></li>
                            <li><a href="/queens#queens">Queens</a></li>
                            <li><a href="/staten#staten">Staten Island</a></li>
                        </ul>
                    </li>
                    <li><a class="nav-link scrollto" href="/list_dropoffs" style="color: white;">Drop-off Locations</a></li>
                    <li><a class="nav-link scrollto" href="/#team" style="color: white;">Team</a></li>
                    <!-- <li><a class="nav-link scrollto" href="#contact">Contact</a></li>
                <li><a class="getstarted scrollto" href="#about">Get Started</a></li> -->
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav><!-- .navbar -->

        </div>
    </header>
  <div class="container">
    <div class="panel panel-info">
      <section style="padding-bottom: 0px;">
        <div class="section-title">
                <h2>Drop-Off Locations</h2>
            </div>
      </section>
      <div class="container">
        <div class="panel panel-info">
          <div class="panel-heading" align="center">
                          <!-- This is the entry for the search form -->
              <form action="/list_dropoffs">
              <label for="dropoff_type"><h4 class="title">Drop-off Type:</h4></label>
              <select id="dropoff_type" name="dropoff_type">
                <option value="food" selected>Food</option>
                <option value="electronics">Electronics</option>
                <option value="special_waste">Special Waste</option>
              </select>
             
              <label>
              <h4 class="title">
               &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dropoff Address/Borough: </h4> </label>
                <input type="text" name="dropoff_name">
                <input class="btn btn-sm" type="submit" value="Submit">
              </form>
              <!-- end of the web form -->

          </div>
        </div>
      </div>


      <!-- This is the placeholder for the plot of of the stations -->
      <!-- We will fill it using Javascript, by calling the API call --> 
      <!-- that returns back the image --> 
      <div align="center">
        <img id="dropoff_map_placeholder" class="center-block" />
        <br>
        <br>
      </div>
    <script>
      fetch("/dropoff_map?" + api_call_params)
      .then(function(response){
         // Parse API response as a JSON object
         return response.json();
      })
      .then(function(data){
         // The "data" is the JSON response of the API call
        
         let map_image_html_tag = document.querySelector("#dropoff_map_placeholder");
        
        // The "data" object contains the JSON response of the API
        // We get the "image_data" key from the JSON response and fill 
        // the value of the "src" attribute of the HTML <img> tag. 
         map_image_html_tag.src = data.image_data;
      });
      </script>

    <label id="search-input"><h4 class="title"></h4>
    <br>
    </label> 
    <br>

      <!-- This table will be used to display the results of the Citibike stations -->
      <!-- We do not have to use a table, we can create other approaches -->
      <!-- for showing the data (e.g., create one "box" or "card" for each station) -->
      <div style="overflow-x:auto;">

      <table class="table table-striped table-bordered table-hover">
        <thead id = "table-header">
        </thead>
        <!-- Placeholder for the list of drop offs -->
        <tbody id="data-output">
          <!-- We will put the list of stations from the API call here. -->
        </tbody>
      </table>
        </div>

      <script>
      fetch("/dropoff_list_api?" + api_call_params)
      .then(function(response){
        return response.json();
      }).then(
        function(data){
        // We will create a list of rows for the table 
        // using the loop below (one table row per station)
        let copy_data = data;
        let label_placeholder = document.querySelector("#search-input h4");
        // Find the HTML table with id="#data-output"
        let search_label = "Current Search Input: ";
        search_label += copy_data.type_query;
        search_label += "  drop-off with address/borough as ";
        if (copy_data.search_query)
        {
          search_label += copy_data.search_query;
        }
        else
        {
          search_label += "not specified";
        }
        label_placeholder.innerHTML = search_label;
        //food: borough, name, address, open_month, hours, notes
        //electronics: borough, name, address
        //pharm: borough, name, address
        //special_waste: borough, name, address, city, state
        let header_placeholder = document.querySelector("#table-header");
        let table_header = "";
        table_header += `
            <tr>
            <th>Borough</th>
            <th>Name</th>
            <th>Address</th>`;
        if (data.type_query == 'food')
        {
          table_header += `
          <th> Months Open</th>
         <th> Open Hours </th>
         <th> Special Notes </th>`;
         } 
        table_header += `</tr>`;
        
        header_placeholder.innerHTML = table_header;
        let row_placeholder = document.querySelector("#data-output");
        let table_rows = "";
        for(let s of data.dropoffs){//data.dropoffs
            table_rows += `
              <tr>
                  <td>${s.borough}</td>
                  <td>${s.name}</td>
                  <td>${s.address}</td>`
            ;
            if (data.type_query == 'food')
            {
                  if (s.open_month)
                  {
                    table_rows += `<td>${s.open_month}</td>`;
                  }
                    else
                    {
                      table_rows += `<td> No information </td>`;
                    }
                  
                  if (s.hours)
                  {
                    table_rows += `<td>${s.hours}</td>`;
                  }
                    else
                    {
                      table_rows += `<td> No information </td>`;
                    }
                    if (s.notes)
                  {
                    table_rows += `<td>${s.notes}</td>`;
                  }
                    else
                    {
                      table_rows += `<td> No information </td>`;
                    }
            } 
            table_rows += `</tr>`;
        }
        
        // And now we populate the table by adding the list
        // of rows that we created
        row_placeholder.innerHTML = table_rows;
        }
      );
      </script>


    </div>
  </div>
</body>


<!-- <script src="/Green/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/Green/assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="/Green/assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="/Green/assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="/Green/assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <!-- <script src="/Green/assets/js/main.js"></script>  -->


</html>